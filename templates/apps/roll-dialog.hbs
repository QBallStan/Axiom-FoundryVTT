<div class="axiom-roll-dialog">
  <section class="axiom-roll-body">

    {{!-- ================================= --}}
    {{!-- BASE POOL SECTION --}}
    {{!-- ================================= --}}
    <div class="axiom-section" data-section="base">
      <div class="section-header" data-action="toggleBase">
        <span>Base Pool</span>
        <span class="value">{{basePool}}</span>
      </div>

      <div class="section-expand" data-expand-body>
        {{#each breakdown}}
        <div class="line">
          <span class="line-label">{{label}}</span>
          <span class="line-value">{{value}}</span>
        </div>
        {{/each}}
      </div>
    </div>


    {{!-- ================================= --}}
    {{!-- MODIFIERS SECTION --}}
    {{!-- ================================= --}}
    <div class="axiom-section" data-section="mods">
      <div class="section-header" data-action="toggleMods">
        <span>Modifiers</span>
        <span class="value">{{activeModifierTotal}}</span>
      </div>

      {{!-- ALWAYS VISIBLE: ADDITIONAL MODIFIER --}}
      <div class="line manual-mod always-visible">
        <span class="line-label">Additional Modifier</span>
        <div class="manual-controls">
          <button data-action="modMinus">âˆ’</button>
          <button data-action="modPlus">+</button>
          <span class="manual-value">{{manualMod}}</span>
        </div>
      </div>

      {{!-- COLLAPSIBLE CONTENT (ALWAYS IN DOM, JS CONTROLS HEIGHT) --}}
      <div class="section-expand" data-expand-body>
        {{!-- ACTIVE MODIFIER LIST --}}
        {{#each appliedModifiers}}
        <div class="line">
          <input type="checkbox"
                 {{#if active}}checked{{/if}}
                 data-id="{{id}}"
                 data-action="toggleMod">
          <span class="line-label">{{label}}</span>
          <span class="line-value">{{value}}</span>
        </div>
        {{/each}}

        {{!-- COMMON MODIFIER DROPDOWN --}}
        <div class="line">
          <select name="addCommonMod">
            <option value="">Common modifiers...</option>
            {{#each commonModifiers}}
            <option value="{{value}}">{{label}}</option>
            {{/each}}
          </select>
        </div>
      </div>
    </div>


    {{!-- ================================= --}}
    {{!-- DIFFICULTY --}}
    {{!-- ================================= --}}
    <div class="axiom-diff-row">
      <label>Difficulty</label>
      <select name="difficulty">
        {{#each difficultyOptions}}
        <option value="{{value}}" {{#if (eq ../difficulty value)}}selected{{/if}}>
          {{label}}
        </option>
        {{/each}}
      </select>
    </div>

    {{!-- ================================= --}}
    {{!-- ACTION POINTS --}}
    {{!-- ================================= --}}
    <div class="axiom-ap-row">
      <label>Action Points:</label>

      <div class="ap-buttons">
        {{!-- The selected AP value is stored in ap --}}
        {{!-- Buttons highlight when their number == ap --}}
        {{#each (array 0 1 2 3)}}
          <button type="button"
                  class="ap-btn {{#if (eq ../ap this)}}active{{/if}}"
                  data-action="setAP"
                  data-value="{{this}}">
            {{this}}
          </button>
        {{/each}}
      </div>
    </div>

  </section>

  {{!-- ================================= --}}
  {{!-- FOOTER WITH ROLL BUTTON --}}
  {{!-- ================================= --}}
  <footer class="axiom-roll-footer">
    <div class="roll-footer-layout">
      <select name="rollMode" class="roll-mode-select">
        {{#each rollModes}}
          <option value="{{@key}}" {{#if (eq ../rollMode @key)}}selected{{/if}}>
            {{this}}
          </option>
        {{/each}}
      </select>

      <button type="submit" data-action="roll">
        <i class="fa-solid fa-dice-d8"></i> Roll {{finalPool}} Dice
      </button>
    </div>
  </footer>
</div>
